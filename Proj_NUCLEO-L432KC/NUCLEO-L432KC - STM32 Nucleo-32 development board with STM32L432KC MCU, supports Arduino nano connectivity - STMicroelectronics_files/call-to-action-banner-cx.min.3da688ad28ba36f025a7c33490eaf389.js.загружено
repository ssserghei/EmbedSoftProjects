var STFED=STFED||{};STFED.validateEmail={init:function(d){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(d).toLowerCase())}};
STFED.showCtaBanner={init:function(d){var f=d.data("init");try{if("undefined"!==typeof f.mode)switch(f.mode){case "onload":d.removeClass("cta-hidden");break;case "onscroll":var b=f.pixels||0;$(window).on("scroll",function g(a){pageYOffset>=b&&(d.removeClass("cta-hidden"),$(window).off("scroll",g))});break;case "ontime":var a=setTimeout(function(){d.removeClass("cta-hidden");clearTimeout(a)},1E3*(f.seconds||0))}}catch(c){}}};
$(window).on("load",function(){var d=$(".js-call-to-action-banner");d&&STFED.showCtaBanner.init(d);var f=$(d).hasClass("logged-in");$(".js-call-to-action-form").on("submit",function(b){b=b||window.event;b.preventDefault();var a=$(this);b=$(b.target).closest(".st-call-to-action");var c=a.attr("data-type"),d=a.attr("data-redirect");if("pageTraffic"===c)b.addClass("cta-hidden"),window.open(d,"_self");else{var g=a.find("#cta-email"),l=a.find("#stFirstName").val(),m=a.find("#stLastName").val(),n=f?!0:
STFED.validateEmail.init(g.val()),v=a.find('[name\x3d"newsletterSubscription"]').val(),h=a.attr("data-loggedInUser"),w=a.attr("data-loggedInEmail");a=(a.attr("data-premContentPath")||"").replace("st_com_cx/","st_com/");var e=$("#relatedAttributes"),p=e.data("touchpoint-related-product"),q=e.data("touchpoint-related-application"),r=e.data("touchpoint-name"),k=STUtils.getIpAddress(),x=STUtils.getIpGeolocatedCountryCode(k),t=STUtils.getIpGeolocatedCountry(k).replace(/\+/g," ");e=e.data("local-code");
var u=$("meta[name\x3dContent-Language]").attr("content")||"en";"newsletterSubscription"===c&&(h||n)?(b.hide(),h||$("#ctaModal").modal("show"),$.ajax({url:"/bin/subscribe",type:"POST",data:{"recipient.email":h?w.toLowerCase():g.val().toLowerCase(),subscriptions:v,"subscription.path":window.location.origin+window.location.pathname,"recipient.ipAddress":k,"recipient.ipGeolocatedCountryElement.ipGeolocatedCountry":t,pageLanguage:u,touFlag:!0,optinEmail:!0,stFirstName:l,stLastName:m}}).success(function(){h&&
($("#ctaModalLoggedIn").modal("show"),setTimeout(function(){window.location.href=d},3E3))}).fail(function(){console.log("can't send data to campaign")})):"eventSubscription"===c?(b.addClass("cta-hidden"),window.location.href=d):h&&"premiumContent"===c?(b.addClass("cta-hidden"),window.location.href=a+".html"):"premiumContent"===c&&n&&!h&&(c=new Date,c.setTime(c.getTime()+2592E6),c={expires:c,path:"/"},setCookie("landingPage_emailAddress",g.val(),c),b.addClass("cta-hidden"),$("#ctaModal").modal("show"),
$.ajax({url:"/bin/st/trackNotLoggedGC",async:!1,type:"POST",dataType:"json",data:{email:g.val(),country:t,countryCode:x,optinEmail:"on",localeCode:e?e:u,touchpointName:r?r:window.location.pathname,userIp:k,touchpointRelatedProduct:p?p:"",touchpointRelatedApplication:q?q:"",trustLevel:75,isBanner:"true",premiumPath:a,stFirstName:l,stLastName:m}}).fail(function(){console.log("can't send data to campaign")}))}});this.setCookie=function(b,a,c){c.expires&&c.expires.toUTCString&&(c.expires=c.expires.toUTCString());
b=b+"\x3d"+a;for(var d in c)b+="; "+d,a=c[d],!0!==a&&(b+="\x3d"+a);document.cookie=b};$(".js-close-call-to-action").on("click",function(b){d.addClass("cta-hidden")})});